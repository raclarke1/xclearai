---
import ChatWidget from '../components/ChatWidget.astro';
interface Props {
  title: string;
  description?: string;
  canonical?: string;
  image?: string;
}

const { 
  title, 
  description = "Utah's premier AI-powered IT company. Managed IT services, cybersecurity, cloud solutions, and intelligent automation for small businesses. Future-proof your business with XclearAI.",
  canonical = Astro.url.href,
  image = "https://xclearai.com/og-image.png",
  keywords = ""
} = Astro.props;

const siteTitle = `${title} | XclearAI`;
const siteName = "XclearAI";

// Default keywords - IT + AI focused
const defaultKeywords = "IT services Utah, managed IT services, MSP Utah, IT company Utah, AI automation, managed service provider, IT support Utah, cybersecurity Utah, cloud services, AI-powered IT, future-proof IT, small business IT, IT consulting Utah, network solutions, business automation, IT infrastructure, tech support Utah, Lehi IT company, Salt Lake City IT services";
const finalKeywords = keywords || defaultKeywords;

// JSON-LD Structured Data - Enhanced for IT Services
const organizationSchema = {
  "@context": "https://schema.org",
  "@type": ["LocalBusiness", "ProfessionalService"],
  "@id": "https://xclearai.com/#organization",
  "name": "XclearAI",
  "alternateName": ["Xclear AI", "XclearAI IT Services"],
  "description": "Utah-based IT company offering managed IT services, cybersecurity, cloud solutions, and AI-powered business automation. We help small businesses future-proof their technology.",
  "url": "https://xclearai.com",
  "logo": "https://xclearai.com/favicon.svg",
  "image": "https://xclearai.com/og-image.png",
  "telephone": "+1-385-336-6005",
  "email": "info@xclearai.com",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "2600 N Ashton Blvd #200B",
    "addressLocality": "Lehi",
    "addressRegion": "UT",
    "postalCode": "84043",
    "addressCountry": "US"
  },
  "geo": {
    "@type": "GeoCoordinates",
    "latitude": 40.4141,
    "longitude": -111.8508
  },
  "areaServed": [
    {
      "@type": "City",
      "name": "Lehi",
      "containedInPlace": { "@type": "State", "name": "Utah" }
    },
    {
      "@type": "City", 
      "name": "Salt Lake City",
      "containedInPlace": { "@type": "State", "name": "Utah" }
    },
    {
      "@type": "City",
      "name": "Provo",
      "containedInPlace": { "@type": "State", "name": "Utah" }
    },
    {
      "@type": "State",
      "name": "Utah"
    },
    {
      "@type": "Country",
      "name": "United States"
    }
  ],
  "priceRange": "$$",
  "openingHoursSpecification": {
    "@type": "OpeningHoursSpecification",
    "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
    "opens": "09:00",
    "closes": "17:00"
  },
  "sameAs": [],
  "knowsAbout": [
    "Managed IT Services",
    "Cybersecurity",
    "Cloud Computing",
    "AI Automation",
    "Network Infrastructure",
    "VoIP Systems",
    "IT Consulting",
    "Business Process Automation"
  ],
  "hasOfferCatalog": {
    "@type": "OfferCatalog",
    "name": "IT and AI Services",
    "itemListElement": [
      {
        "@type": "OfferCatalog",
        "name": "IT Services",
        "itemListElement": [
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Managed IT Services" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Cybersecurity Solutions" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Cloud Services" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Network Solutions" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "VoIP & Communications" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "IT Consulting" } }
        ]
      },
      {
        "@type": "OfferCatalog",
        "name": "AI Automation",
        "itemListElement": [
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Email Management Automation" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Intelligent Scheduling" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Customer Support Bots" } },
          { "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Workflow Automation" } }
        ]
      }
    ]
  }
};

const serviceSchema = {
  "@context": "https://schema.org",
  "@type": "Service",
  "serviceType": ["Managed IT Services", "AI Business Automation", "Cybersecurity Services"],
  "provider": {
    "@type": "LocalBusiness",
    "name": "XclearAI",
    "@id": "https://xclearai.com/#organization"
  },
  "areaServed": [
    { "@type": "State", "name": "Utah" },
    { "@type": "Country", "name": "United States" }
  ],
  "description": "Comprehensive IT services and AI automation for small businesses. Managed IT support, cybersecurity, cloud solutions, and intelligent automation to future-proof your business.",
  "offers": {
    "@type": "Offer",
    "availability": "https://schema.org/InStock",
    "priceSpecification": {
      "@type": "PriceSpecification",
      "priceCurrency": "USD"
    }
  }
};

const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "XclearAI - IT Services & AI Automation",
  "url": "https://xclearai.com",
  "description": description,
  "publisher": {
    "@type": "Organization",
    "name": "XclearAI",
    "@id": "https://xclearai.com/#organization"
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://xclearai.com/services?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
};

// FAQ Schema for featured snippets
const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What IT services does XclearAI offer?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "XclearAI offers comprehensive IT services including managed IT support, cybersecurity, cloud services, network solutions, VoIP communications, and IT consulting. We also provide AI-powered automation for email, scheduling, and customer support."
      }
    },
    {
      "@type": "Question",
      "name": "How can AI improve my business IT?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "AI can automate repetitive IT tasks, provide 24/7 monitoring and alerting, streamline help desk support, automate email management, and enable predictive maintenance. This reduces costs, improves response times, and future-proofs your IT infrastructure."
      }
    },
    {
      "@type": "Question",
      "name": "Do you provide IT services in Utah?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes! XclearAI is based in Lehi, Utah and provides IT services throughout the state including Salt Lake City, Provo, Orem, and surrounding areas. We also serve clients nationwide with remote IT support and AI automation."
      }
    },
    {
      "@type": "Question",
      "name": "What makes XclearAI different from other MSPs?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "XclearAI combines traditional managed IT services with cutting-edge AI automation. While other MSPs react to problems, our AI-powered systems proactively prevent issues, automate routine tasks, and help your business stay ahead of technology trends."
      }
    }
  ]
};
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Primary Meta Tags -->
    <title>{siteTitle}</title>
    <meta name="title" content={siteTitle} />
    <meta name="description" content={description} />
    <meta name="keywords" content={finalKeywords} />
    <meta name="author" content="XclearAI" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href={canonical} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonical} />
    <meta property="og:title" content={siteTitle} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={image} />
    <meta property="og:site_name" content={siteName} />
    <meta property="og:locale" content="en_US" />
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonical} />
    <meta name="twitter:title" content={siteTitle} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={image} />
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(serviceSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
    <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
    
    <!-- Geo Meta Tags for Local SEO -->
    <meta name="geo.region" content="US-UT" />
    <meta name="geo.placename" content="Lehi, Utah" />
    <meta name="geo.position" content="40.4141;-111.8508" />
    <meta name="ICBM" content="40.4141, -111.8508" />
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Theme Detection -->
    <script is:inline>
      // Check for saved theme preference or default to light
      const theme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', theme);
    </script>
  </head>
  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/" class="logo">
          <img src="/logo.svg" alt="XclearAI" class="logo-img" />
        </a>
        <a href="tel:+13853366005" class="nav-phone mobile-phone">
          <svg class="phone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
          </svg>
          <span class="phone-number">(385) 336-6005</span>
        </a>
        <div class="nav-links">
          <a href="/">Home</a>
          <a href="/services">Services</a>
          <a href="/blog">Blog</a>
          <a href="/about">About</a>
          <a href="tel:+13853366005" class="nav-phone desktop-phone">
            <svg class="phone-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
            </svg>
            (385) 336-6005
          </a>
          <a href="/contact" class="nav-cta">Get Started</a>
          <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
            <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path>
            </svg>
            <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
            </svg>
          </button>
        </div>
        <button class="mobile-menu" aria-label="Menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </nav>
    
    <main>
      <slot />
    </main>
    
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-brand">
          <img src="/logo.svg" alt="XclearAI" class="footer-logo-img" />
          <p>AI automation for small businesses.</p>
        </div>
        <div class="footer-links">
          <div class="footer-col">
            <h4>Company</h4>
            <a href="/about">About Us</a>
            <a href="/services">Services</a>
            <a href="/blog">IT Insights Blog</a>
            <a href="/contact">Contact</a>
          </div>
          <div class="footer-col">
            <h4>Contact</h4>
            <p>Utah, USA</p>
            <p>(385) 336-6005</p>
            <a href="mailto:info@xclearai.com">info@xclearai.com</a>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2026 XclearAI. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <ChatWidget />

    <script is:inline>
      // Theme toggle
      const toggle = document.getElementById('theme-toggle');
      toggle.addEventListener('click', () => {
        const current = document.documentElement.getAttribute('data-theme');
        const next = current === 'light' ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
      });

      // Mobile menu toggle
      const mobileMenu = document.querySelector('.mobile-menu');
      const navLinks = document.querySelector('.nav-links');
      
      mobileMenu.addEventListener('click', () => {
        mobileMenu.classList.toggle('active');
        navLinks.classList.toggle('mobile-open');
        document.body.classList.toggle('menu-open');
      });

      // Close menu when clicking a link
      navLinks.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.remove('active');
          navLinks.classList.remove('mobile-open');
          document.body.classList.remove('menu-open');
        });
      });
    </script>
  </body>
</html>

<style is:global>
  /* Theme Variables */
  :root,
  [data-theme="light"] {
    --bg-primary: #ffffff;
    --bg-secondary: #f8fafc;
    --bg-tertiary: #f0f9ff;
    --bg-card: #ffffff;
    --bg-nav: rgba(255, 255, 255, 0.95);
    
    --text-primary: #1a1a2e;
    --text-secondary: #4b5563;
    --text-muted: #6b7280;
    --text-faint: #9ca3af;
    
    --border-color: #e5e7eb;
    --border-hover: #93c5fd;
    
    --accent: #2563eb;
    --accent-hover: #1d4ed8;
    --accent-light: #dbeafe;
    --accent-border: #93c5fd;
    
    --gradient-start: #f0f9ff;
    --gradient-end: #ffffff;
    
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
    --shadow-md: 0 4px 12px rgba(37, 99, 235, 0.1);
    --shadow-lg: 0 10px 40px rgba(37, 99, 235, 0.12);
  }
  
  [data-theme="dark"] {
    --bg-primary: #0a0a0f;
    --bg-secondary: #111118;
    --bg-tertiary: #0f0f1a;
    --bg-card: #16161f;
    --bg-nav: rgba(10, 10, 15, 0.95);
    
    --text-primary: #f1f5f9;
    --text-secondary: #cbd5e1;
    --text-muted: #94a3b8;
    --text-faint: #64748b;
    
    --border-color: #1e293b;
    --border-hover: #3b82f6;
    
    --accent: #3b82f6;
    --accent-hover: #60a5fa;
    --accent-light: rgba(59, 130, 246, 0.15);
    --accent-border: rgba(59, 130, 246, 0.3);
    
    --gradient-start: #0f0f1a;
    --gradient-end: #0a0a0f;
    
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.4);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  html {
    font-family: 'Inter', system-ui, sans-serif;
    scroll-behavior: smooth;
  }
  
  body {
    background: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    transition: background 0.3s ease, color 0.3s ease;
  }
  
  a {
    color: inherit;
    text-decoration: none;
  }
  
  .nav {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 100;
    background: var(--bg-nav);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-color);
    box-shadow: var(--shadow-sm);
    transition: background 0.3s ease, border-color 0.3s ease;
  }
  
  .nav-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  .logo {
    display: flex;
    align-items: center;
  }
  
  .logo-img {
    height: 32px;
    width: auto;
  }
  
  .footer-logo-img {
    height: 28px;
    width: auto;
  }
  
  /* Adjust logo for dark mode */
  [data-theme="dark"] .logo-img,
  [data-theme="dark"] .footer-logo-img {
    filter: brightness(1.4) saturate(1.2);
  }
  
  @media (max-width: 480px) {
    .logo-img {
      height: 26px;
    }
  }
  
  .nav-links {
    display: flex;
    gap: 2rem;
    align-items: center;
  }
  
  .nav-links a {
    color: var(--text-secondary);
    transition: color 0.2s;
    font-weight: 500;
  }
  
  .nav-links a:hover {
    color: var(--accent);
  }
  
  .nav-phone {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--accent-light);
    color: var(--accent) !important;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-weight: 600;
    border: 1px solid var(--accent-border);
    transition: all 0.2s ease;
  }
  
  .nav-phone:hover {
    background: var(--accent);
    color: white !important;
    border-color: var(--accent);
  }
  
  .nav-phone .phone-icon {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }
  
  /* Mobile phone button - shown on mobile, hidden on desktop */
  .mobile-phone {
    display: none;
  }
  
  /* Desktop phone button - shown on desktop, hidden on mobile */
  .desktop-phone {
    display: flex;
  }
  
  .nav-cta {
    background: var(--accent);
    color: white !important;
    padding: 0.5rem 1.25rem;
    border-radius: 6px;
    font-weight: 500;
  }
  
  .nav-cta:hover {
    background: var(--accent-hover);
    color: white !important;
  }
  
  .theme-toggle {
    background: none;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 0.5rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
  }
  
  .theme-toggle:hover {
    border-color: var(--accent);
    background: var(--accent-light);
  }
  
  .theme-toggle svg {
    width: 20px;
    height: 20px;
    color: var(--text-secondary);
  }
  
  [data-theme="light"] .moon-icon {
    display: none;
  }
  
  [data-theme="dark"] .sun-icon {
    display: none;
  }
  
  .mobile-menu {
    display: none;
    flex-direction: column;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px;
  }
  
  .mobile-menu span {
    width: 24px;
    height: 2px;
    background: var(--text-primary);
    border-radius: 2px;
  }
  
  main {
    min-height: 100vh;
    padding-top: 4rem;
  }
  
  .footer {
    background: var(--bg-secondary);
    border-top: 1px solid var(--border-color);
    padding: 4rem 2rem 2rem;
    transition: background 0.3s ease, border-color 0.3s ease;
  }
  
  .footer-container {
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .footer-brand p {
    color: var(--text-muted);
    margin-top: 0.5rem;
  }
  
  .footer-links {
    display: flex;
    gap: 4rem;
    margin-top: 2rem;
  }
  
  .footer-col h4 {
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-faint);
    margin-bottom: 1rem;
  }
  
  .footer-col a, .footer-col p {
    display: block;
    color: var(--text-muted);
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
  }
  
  .footer-col a:hover {
    color: var(--accent);
  }
  
  .footer-bottom {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border-color);
    color: var(--text-faint);
    font-size: 0.875rem;
  }
  
  @media (max-width: 768px) {
    .nav-container {
      position: relative;
    }
    
    .nav-links {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--bg-primary);
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      z-index: 1000;
      display: none;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    
    .nav-links.mobile-open {
      display: flex;
      opacity: 1;
      visibility: visible;
    }
    
    .nav-links a {
      font-size: 1.5rem;
      padding: 0.5rem 1rem;
    }
    
    .nav-links .nav-cta {
      margin-top: 1rem;
      padding: 1rem 2rem;
      font-size: 1.25rem;
    }
    
    /* Show mobile phone button, hide desktop phone button */
    .mobile-phone {
      display: flex;
      margin-right: 0.75rem;
    }
    
    .mobile-phone .phone-number {
      display: none;
    }
    
    .mobile-phone .phone-icon {
      width: 20px;
      height: 20px;
    }
    
    .desktop-phone {
      display: none !important;
    }
    
    .mobile-menu {
      display: flex;
      z-index: 1001;
      position: relative;
    }
    
    .mobile-menu.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }
    
    .mobile-menu.active span:nth-child(2) {
      opacity: 0;
    }
    
    .mobile-menu.active span:nth-child(3) {
      transform: rotate(-45deg) translate(5px, -5px);
    }
    
    .mobile-menu span {
      transition: all 0.3s ease;
    }
    
    body.menu-open {
      overflow: hidden;
    }
    
    .footer-links {
      flex-direction: column;
      gap: 2rem;
    }
  }
</style>
